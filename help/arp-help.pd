#N canvas 400 200 530 470 16;
#X declare -lib blunt;
#X obj 70 390 *~;
#X obj 70 420 dac~;
#X obj 270 180 tgl 15 0 empty empty empty 17 7 0 10 #0e4345 #fcfcfc #fcfcfc 0 1;
#X floatatom 330 210 0 0 0 0 - - - 0;
#X obj 270 210 metro;
#X floatatom 110 110 0 0 0 2 root - - 0;
#X floatatom 120 170 0 0 0 0 - - - 0;
#X obj 70 360 *~;
#N canvas 930 200 360 330 scaler 0;
#X obj 100 220 sel;
#X obj 240 220 sel;
#X obj 160 30 inlet;
#X obj 240 140 inlet;
#X obj 150 200 outlet;
#X obj 210 30 inlet;
#X obj 100 190 <= 0;
#X obj 240 190 >=;
#X msg 40 260 1;
#X msg 80 260 -1;
#X obj 120 120 cupqb -1;
#X msg 90 90 step \$1;
#X obj 50 20 1;
#X obj 50 50 * 1;
#X obj 30 90 t b f;
#X connect 0 1 8 0;
#X connect 1 1 9 0;
#X connect 2 0 10 2;
#X connect 3 0 7 1;
#X connect 5 0 12 0;
#X connect 6 0 0 0;
#X connect 7 0 1 0;
#X connect 8 0 14 0;
#X connect 9 0 14 0;
#X connect 10 0 6 0;
#X connect 10 0 4 0;
#X connect 10 0 7 0;
#X connect 11 0 10 1;
#X connect 12 0 13 0;
#X connect 13 0 11 0;
#X connect 14 0 12 0;
#X connect 14 1 13 1;
#X coords 0 -1 1 1 54 54 2 118 118;
#X restore 270 260 pd scaler;
#X obj 50 80 cupqb;
#N canvas 930 200 550 380 commands 0;
#X obj 60 60 cupqb;
#X obj 220 120 cupqb;
#X obj 300 150 cupqb;
#X text 300 130 reference pitch;
#X msg 300 210 ref \$1;
#X msg 230 270 print;
#X obj 140 90 cupqb;
#X msg 140 150 oct \$1;
#X obj 60 310 s cmd;
#X text 290 270 print current scale;
#X msg 60 120 n \$1;
#X msg 220 180 tet \$1;
#X text 60 40 scale size;
#X text 140 70 semitone steps per octave;
#X text 220 100 tones in equal temperament;
#X connect 0 0 10 0;
#X connect 1 0 11 0;
#X connect 2 0 4 0;
#X connect 4 0 8 0;
#X connect 5 0 8 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 10 0 8 0;
#X connect 11 0 8 0;
#X restore 360 100 pd commands;
#X obj 380 180 loadbang;
#X msg 330 180 160;
#X text 340 240 peak;
#X obj 280 20 cnv 15 42 27 empty empty arp 0 12 0 24 #535512 #fcfcfc 0;
#X obj 340 260 cupqb 14;
#N canvas 930 200 450 320 accent 0;
#X obj 70 50 inlet;
#X obj 70 240 outlet~;
#X obj 70 160 1;
#X obj 70 110 sel 0 1 2 3;
#X floatatom 210 80 0 0 0 0 - - - 0;
#X floatatom 270 80 0 0 0 0 - - - 0;
#X obj 70 210 zp~ 1;
#X floatatom 130 210 0 0 0 0 - - - 0;
#X obj 210 110 / 100;
#X obj 270 110 / 100;
#X obj 70 80 mod 4;
#X floatatom 130 80 0 0 0 0 - - - 0;
#X obj 190 110 b, f 1;
#X floatatom 210 40 0 0 0 0 - - - 0;
#X obj 110 160 0.66;
#X obj 210 160 0.66;
#X obj 160 160 0.75;
#X connect 0 0 10 0;
#X connect 2 0 6 0;
#X connect 3 0 2 0;
#X connect 3 1 14 0;
#X connect 3 2 16 0;
#X connect 3 3 15 0;
#X connect 3 4 12 0;
#X connect 4 0 8 0;
#X connect 5 0 9 0;
#X connect 6 0 1 0;
#X connect 7 0 6 1;
#X connect 8 0 16 1;
#X connect 9 0 14 1;
#X connect 9 0 15 1;
#X connect 10 0 3 0;
#X connect 11 0 10 1;
#X connect 12 0 15 0;
#X connect 13 0 4 0;
#X connect 13 0 5 0;
#X connect 14 0 6 0;
#X connect 15 0 6 0;
#X connect 16 0 6 0;
#X restore 120 360 pd accent;
#X obj 120 390 hsl 128 15 0.001 1 1 0 empty empty empty -2 -8 0 10 #2f004d #fcfcfc #fcfcfc 0 1;
#X obj 70 230 r cmd;
#X floatatom 120 420 0 0 0 0 - - - 0;
#N canvas 930 200 830 630 notation 0;
#X text 310 40 change the root+intervals respectively;
#X text 590 180 major scale;
#X obj 140 110 s cmd;
#X obj 350 320 s cmd;
#X msg 370 150 foo bar 10;
#X text 560 210 major to minor;
#X msg 220 70 --;
#X msg 260 70 ++;
#X msg 230 330 . 4 7 11;
#X obj 50 410 s cmd;
#X msg 120 440 print;
#X msg 70 200 . . +;
#X msg 60 170 . - .;
#X msg 90 260 . + .;
#X msg 100 290 . . -;
#X text 480 150 unrecognized terms are skipped;
#X msg 220 130 ^12 --12;
#X text 310 360 inversion;
#X msg 230 390 <;
#X msg 270 390 >;
#X text 310 390 inversion with unaltered root;
#X obj 120 530 s cmd;
#X msg 230 360 <<2;
#X msg 270 450 . 2 4 7;
#X msg 310 480 . >;
#X msg 270 480 . <;
#X text 350 480 root note is excluded from the inversion;
#X text 330 540 shift root by 3rd interval amount;
#X text 360 510 swap 2nd and 3rd intervals;
#X msg 270 510 #2 &3 &2;
#X msg 270 540 # +&3;
#X msg 270 570 #1 ++&-3;
#X text 360 570 shift intervals by -3rd interval amount;
#X msg 110 320 + --;
#X msg 270 100 ++12;
#X msg 220 100 --12;
#X msg 140 40 n 4 \, 40 16 21 23;
#X msg 50 140 n 3 \, . 4 7;
#X msg 380 180 n 7 \, do 2 4 5 7 9 11;
#X msg 400 240 #2 + f s ++;
#X msg 410 270 #2 - f s --;
#X msg 420 300 #2 *1.5 f s **1.5;
#X msg 430 330 #2 /1.5 f s //1.5;
#X text 140 220 same shift for the next two intervals, f 18;
#X msg 230 420 -1<;
#X msg 270 420 -1>;
#X text 300 70 do the same shift for all elements that follow;
#X floatatom 220 260 0 0 0 0 - - - 0;
#X msg 270 360 >>;
#X text 310 420 exclude last interval from the inversion;
#X msg 220 290 send >\$1;
#X msg 80 230 . 2++;
#X msg 390 210 #2 3 fa so 8 10;
#X msg 350 110 # 35;
#X text 410 100 list with onset \, useful for changing the root note, f 27;
#X text 540 240 change notes relative to their current value, f 22;
#X connect 4 0 3 0;
#X connect 6 0 2 0;
#X connect 7 0 2 0;
#X connect 8 0 9 0;
#X connect 10 0 21 0;
#X connect 11 0 9 0;
#X connect 12 0 9 0;
#X connect 13 0 9 0;
#X connect 14 0 9 0;
#X connect 16 0 2 0;
#X connect 18 0 9 0;
#X connect 19 0 9 0;
#X connect 22 0 9 0;
#X connect 23 0 21 0;
#X connect 24 0 21 0;
#X connect 25 0 21 0;
#X connect 29 0 21 0;
#X connect 30 0 21 0;
#X connect 31 0 21 0;
#X connect 33 0 9 0;
#X connect 34 0 2 0;
#X connect 35 0 2 0;
#X connect 36 0 2 0;
#X connect 37 0 9 0;
#X connect 38 0 3 0;
#X connect 39 0 3 0;
#X connect 40 0 3 0;
#X connect 41 0 3 0;
#X connect 42 0 3 0;
#X connect 44 0 21 0;
#X connect 45 0 21 0;
#X connect 47 0 50 0;
#X connect 48 0 9 0;
#X connect 50 0 9 0;
#X connect 51 0 9 0;
#X connect 52 0 3 0;
#X connect 53 0 3 0;
#X restore 360 130 pd notation;
#X obj 270 330 pack;
#X floatatom 330 330 0 0 0 0 - - - 0;
#X msg 270 390 \$1+\$2;
#X text 280 360 note + semitone;
#N canvas 930 200 380 370 ks 0;
#X obj 40 40 noise~;
#X obj 40 160 *~;
#X obj 50 130 vline~;
#X obj 40 250 +~;
#X obj 120 40 inlet;
#X obj 40 310 outlet~;
#X obj 50 280 delwrite~ \$0buf 1000;
#X obj 170 140 delread4~ \$0buf;
#X obj 50 70 @/ 1000;
#X obj 230 310 block~ 1;
#X obj 170 170 *~ 0.999;
#X obj 170 200 lop~ 6000;
#X msg 50 100 1 \, 0 0 \$1;
#X obj 40 190 *~;
#X obj 160 70 sly log 0.2 1 2300;
#X obj 160 100 clip 0 1;
#X connect 0 0 1 0;
#X connect 1 0 13 0;
#X connect 2 0 1 1;
#X connect 3 0 5 0;
#X connect 3 0 6 0;
#X connect 4 0 8 0;
#X connect 4 0 14 0;
#X connect 7 0 10 0;
#X connect 8 0 7 0;
#X connect 8 0 12 0;
#X connect 10 0 11 0;
#X connect 11 0 3 1;
#X connect 12 0 2 0;
#X connect 13 0 3 0;
#X connect 14 0 15 0;
#X connect 15 0 13 1;
#X restore 70 330 pd ks;
#X obj 50 140 arp 69 7;
#X text 140 140 default args;
#N canvas 930 200 450 300 lib 0;
#X obj 140 120 declare -lib blunt;
#X restore 40 20 pd lib;
#X obj 270 420 s cmd;
#X floatatom 160 110 0 0 0 2 interval - - 0;
#X obj 70 300 mtof;
#N canvas 480 600 450 300 send 0;
#X obj 50 10 inlet;
#X obj 50 40 list split 1;
#X obj 110 70 array set \$0sent 1;
#N canvas 930 200 450 250 (subpatch) 0;
#X array \$0sent 7 float 2;
#X coords 0 12 7 0 200 140 1 0 0;
#X restore 90 130 graph;
#X connect 0 0 1 0;
#X connect 1 1 2 0;
#X restore 160 300 pd send;
#X obj 70 270 arp \$0foo;
#N canvas 930 200 450 300 foo 0;
#X obj 110 110 array define \$0foo 7;
#X obj 110 50 loadbang;
#X msg 110 80 0 40 2 4 5 7 9 11;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X restore 170 270 pd foo;
#X text 110 50 Arpeggiator and music scale constructor;
#X connect 0 0 1 0;
#X connect 0 0 1 1;
#X connect 2 0 4 0;
#X connect 3 0 4 1;
#X connect 4 0 8 0;
#X connect 5 0 26 1;
#X connect 7 0 0 0;
#X connect 8 0 21 0;
#X connect 8 0 16 0;
#X connect 9 0 26 0;
#X connect 11 0 12 0;
#X connect 11 0 15 1;
#X connect 12 0 3 0;
#X connect 15 0 8 2;
#X connect 16 0 7 1;
#X connect 17 0 0 1;
#X connect 17 0 19 0;
#X connect 18 0 33 0;
#X connect 21 0 23 0;
#X connect 22 0 21 1;
#X connect 23 0 29 0;
#X connect 25 0 7 0;
#X connect 26 1 6 0;
#X connect 30 0 26 2;
#X connect 31 0 25 0;
#X connect 33 0 31 0;
#X connect 33 1 32 0;
